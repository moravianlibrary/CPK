(function(){angular.module("favorites",[])})();(function(){function e(c){var b=!1,a="undefined"!==typeof __notif;return{favAdded:function(){if(!0===a&&!1===b){b=!0;var n=c("you_have_unsaved_favorites");__notif.addNotification(n,"favs")}},allFavsRemoved:function(){!0===a&&(__notif.helper.pointers.global.children(".notif-favs").remove(),0===__notif.sourcesRead.unreadCount&&(b=!1,__notif.warning.hide(),__notif.helper.pointers.global.children().first().show()))}}}angular.module("favorites").factory("favsNotifications",e);e.$inject=["translateFilter"]})();(function(){angular.module("favorites").value("Favorite",function(){var c={title:{link:void 0,value:void 0},author:{link:void 0,value:void 0},published:void 0,format:{iconClass:void 0,value:void 0},image:void 0,icon:{value:void 0,style:void 0},created:(new Date).getTime()},b=this;b.parseCurrentSearch=function(a){if("undefined"===typeof a)return console.error("Cannot parse from current search with unknown rank!");a=parseInt(a);if(0>a)return console.error("Invalid rank provided for parsing current search!");
"undefined"===typeof e&&(e=$("div#result-list-placeholder").children(),window.addEventListener("searchResultsLoaded",function(){e=$("div#result-list-placeholder").children()}));var c=e.get(a);c=c.getElementsByClassName("row")[0];b.title(function(){var a=c.querySelector("a.to-favorites-link");if(a)return b.titleLink(a.getAttribute("href")),c.querySelector("a.title").textContent.trim();console.error("Parsing search record title and link failed!")}());b.author(function(){var a=c.querySelector("a.author-info");
if(a)return b.authorLink(a.getAttribute("href")),a.textContent.trim();console.error("Parsing search record author and link failed!")}());b.format(function(){var a=c.querySelector("div.format-list div.iconlabel");if(a)return b.formatIconClass(a.getElementsByTagName("i")[0].getAttribute("class")),a.getElementsByTagName("span")[0].getAttribute("data-orig");console.error("Parsing format icon class failed!");console.error("Parsing record format failed!")}());b.published(function(){var a=c.querySelector("span.summDate");
if(a)return a.textContent.trim();console.error("Parsing publication date failed!")}());b.image(function(){var a=c.getElementsByClassName("coverThumbnail")[0],f=a.getElementsByTagName("img")[0];if("undefined"!==typeof f)return f.getAttribute("src");a=a.getElementsByTagName("i")[0];"undefined"!==typeof a?(b.icon(a.getAttribute("class")),b.iconStyle(a.getAttribute("style"))):console.error("Parsing search image source or icon failed!")}());return b};b.parseCurrentRecord=function(){var a=$("table[summary]"),
c=a.find("tbody tr td[property=author] a");0===c.length&&(c=a.find("tbody tr td[property=creator] a"),0===c.length&&(c=a.find("tbody tr td span[property=contributor] a")));var d=a.find("tbody tr td div.iconlabel");b.titleLink(location.pathname);b.title(function(){var b=a.siblings("h2");if(b.length)return b.find("strong").text();console.error("Parsing record title failed!")}());b.authorLink(function(){var a=c.prop("href");if("string"===typeof a)return a;console.error("Parsing author's link failed!")}());
b.author(function(){var a=c.text();if("string"===typeof a)return a;console.error("Parsing author's name failed!")}());b.formatIconClass(function(){var a=d.children("i");if(a.length)return a.attr("class");console.error("Parsing format icon class failed!")}());b.format(function(){var a=d.children("span");if(a.length)return a.attr("data-orig");console.error("Parsing record format failed!")}());b.published(function(){var b=a.find("tbody tr td span[property=publicationDate]");if(b.length)return b.text();
console.error("Parsing publication year failed!")}());b.image(function(){var c=a.parent().siblings("div.col-sm-3");if(c.length){var d=c.find("img");if(d.length)return d.attr("src");c=c.find("i[class][style]");c.length?(b.icon(c.attr("class")),b.iconStyle(c.attr("style"))):console.error("Parsing record image source or icon failed!")}else console.error("Parsing record image's parent division failed!")}());return b};b.fromObject=function(a){"object"!==typeof a?console.error("Trying to create Favorite from object, but no object passed"):
a.hasOwnProperty("created")?c=a:console.error("Missing timestamp of the object!");return b};b.toObject=function(){return c};b.toString=function(){return JSON.stringify(c)};b.titleLink=function(a){if("undefined"===typeof a)return c.title.link;c.title.link=a;return b};b.title=function(a){if("undefined"===typeof a)return c.title.value;c.title.value=a;return b};b.authorLink=function(a){if("undefined"===typeof a)return c.author.link;c.author.link=a;return b};b.author=function(a){if("undefined"===typeof a)return c.author.value;
c.author.value=a;return b};b.published=function(a){if("undefined"===typeof a)return c.published;c.published=a;return b};b.formatIconClass=function(a){if("undefined"===typeof a)return c.format.iconClass;c.format.iconClass=a;return b};b.format=function(a){if("undefined"===typeof a)return c.format.value;c.format.value=a;return b};b.image=function(a){if("undefined"===typeof a)return c.image;c.image=a;return b};b.icon=function(a){if("undefined"===typeof a)return c.icon.value;c.icon.value=a;return b};b.iconStyle=
function(a){if("undefined"===typeof a)return c.icon.style;c.icon.style=a;return b};b.created=function(){return c.created}});var e=void 0})();(function(){function e(c,b){var a=this;a.create=function(){return new b};a.createFromCurrentRecord=function(){return a.create().parseCurrentRecord()};a.createFromCurrentSearch=function(b){return a.create().parseCurrentSearch(b)};return a}angular.module("favorites").factory("favoritesFactory",e);e.$inject=["$log","Favorite"]})();(function(){function e(c,b,a){function e(a){return new Promise(function(b,c){m.push(a.toObject());d().then(b)["catch"](c)})}function d(){return new Promise(function(a,b){setTimeout(function(){var b=void 0;m.length?b=sessionStorage.setItem(g.name,JSON.stringify(m)):sessionStorage.removeItem(g.name);a(b)},0)})}function f(a){"function"===typeof a&&(h.done?a.call():h.buffer.push(a))}var g={addFavorite:function(c){return new Promise(function(d,g){c instanceof b?(f(function(){e(c).then(d)["catch"](g)}),
a.favAdded()):g("storage.addFavorite(favorite) needs favorite instanceof Favorite !")})},removeFavorite:function(b){return new Promise(function(c,g){"number"!==typeof b?g("Invalid ID provided"):f(function(){for(var y=m.length,f=[],l=!1,h=0;h<y;++h)m[h].created===b?l=!0:f.push(m[h]);!1===l?g("Invalid ID provided"):(m=f,d().then(c)["catch"](g),0===m.length&&a.allFavsRemoved())})})},removeAllFavorites:function(){return new Promise(function(b,c){m=[];a.allFavsRemoved();d().then(b)["catch"](c)})},hasFavorite:function(a){return new Promise(function(c,
d){f(function(){var g=new RegExp("/"+a.replace(/\./,"\\."));if(m){var y=m.find(function(a){return!!a.title.link.match(g)});"undefined"===typeof y?d():c((new b).fromObject(y))}else d()})})},getFavorite:function(c){return new Promise(function(d,g){"number"===typeof c&&0<=c?f(function(){var g=favorite[c];a.favAdded();d((new b).fromObject(g))}):g("Cannot get favorite without an index")})},getFavorites:function(){return new Promise(function(c,d){f(function(){c(m.map(function(c){a.favAdded();return(new b).fromObject(c)}))})})},
name:"_favs"},m=[],h={done:!1,buffer:[]};(function(){setTimeout(function(){var a=sessionStorage.getItem(g.name);null!==a&&(m=JSON.parse(a));h.done=!0;h.buffer.forEach(function(a){a.call()})},0)})();return g}sessionStorage&&"setItem"in sessionStorage?(angular.module("favorites").factory("storage",e),e.$inject=["$log","Favorite","favsNotifications"]):console.error("This browser does not support sessionStorage, no favorites for not logged user can be provided!")})();(function(){function e(c,b,a,e){function d(a,b){localStorage.setItem(a,b);localStorage.removeItem(a)}function f(){function c(d){parseInt(d.key)===h&&("null"===d.newValue?sessionStorage.setItem(b.name,"[]"):(window.clearTimeout(g),sessionStorage.setItem(b.name,d.newValue),"function"===typeof window.__favChanged&&(d=JSON.parse(d.newValue),d.map(function(b){return(new a).fromObject(b)}).forEach(function(a){window.__favChanged(!0,a)}),d.length&&e.favAdded()),window.removeEventListener("storage",c)))}
h=Date.now();sessionStorage.tabId=h;window.addEventListener("storage",c);var g=window.setTimeout(function(){window.removeEventListener("storage",c);sessionStorage.setItem(b.name,"[]");m(!0)},1500);d("giveMeFavorites",h)}function g(){h=sessionStorage.tabId;var a=localStorage.favoritesMasterTab;a!==h&&"rand"!==a||m(!0)}function m(a){function c(a){"giveMeFavorites"==a.key&&a.newValue&&(l=a.newValue,d(a.newValue,sessionStorage.getItem(b.name)))}localStorage.setItem("favoritesMasterTab",h);window.onbeforeunload=
function(){window.removeEventListener("storage",c);localStorage.setItem("favoritesMasterTab",l?l:"rand")};window.addEventListener("storage",c)}"undefined"===typeof sessionStorage.tabId?f():g();window.addEventListener("storage",function(c){"favoritesMasterTab"===c.key?parseInt(c.newValue)!==h&&"rand"!==c.newValue||m():"favAdded"===c.key&&c.newValue?(c=JSON.parse(c.newValue),c=(new a).fromObject(c),b.addFavorite(c),"function"===typeof window.__favChanged&&window.__favChanged(!0,c)):"favRemoved"===c.key&&
c.newValue?(c=JSON.parse(c.newValue),c=(new a).fromObject(c),b.removeFavorite(c.created()),"function"===typeof window.__favChanged&&window.__favChanged(!1,c)):"purgeAllTabs"===c.key&&c.newValue&&b.removeAllFavorites()});(function(){"function"===typeof sendMeFavs&&!0===sendMeFavs()&&b.getFavorites().then(function(a){0!==a.length&&(a={favs:a.map(function(a){return a.toObject()})},$.post("/AJAX/JSON?method=pushFavorites",a).always(function(){d("purgeAllTabs");b.removeAllFavorites();location.reload()}))})})();
return{broadcastAdded:function(a){a=a.toObject();d("favAdded",JSON.stringify(a))},broadcastRemoved:function(a){d("favRemoved",a)}};var h,l}angular.module("favorites").factory("favsBroadcaster",e);e.$inject=["$log","storage","Favorite","favsNotifications"]})();(function(){function e(e,d,f,g,m,h,l){function n(a){(new Promise(function(b,d){m.removeFavorite(a).then(function(){var b=c[a];window.usesIE?b.parentElement.removeChild(b):b.remove();delete c[a];--k.listLength;0===Object.keys(c).length&&q();var d=parseInt(a);k.favorites=k.favorites.filter(function(a){if(a.created()!==d)return!0;h.broadcastRemoved(a);return!1})})["catch"](function(a){f.error(a)});b()})).then(g.$applyAsync)}function t(a){(new Promise(function(b,c){!a instanceof l?c():(k.favorites.push(a),
u(v),1===k.favorites.length&&(q(),k.listLength=1),b())})).then(g.$applyAsync)}function q(){b.hidden=!b.hidden;a.hidden=!a.hidden}function w(){var a=[];Object.keys(k.favSelected).forEach(function(b){!0===k.favSelected[b]&&(b=p(b),a.push(b))});return a}function r(a){var b=w();if(0!==b.length){for(var c=0;c<b.length;++c)b[c]="Solr|"+b[c];b={ids:b};b[a]=!0;d.post("/AJAX/JSON?method=getLightbox&submodule=Cart&subaction=MyResearchBulk",$.param(b),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){Lightbox.changeContent(a.data)});
x.modal("show")}}function u(a){(new Promise(function(b,c){var d=!0;switch(a){case "alphabetical":k.favorites.sort(function(a,b){return a.title()>b.title()});break;case "author":k.favorites.sort(function(a,b){return a.author()>b.author()});break;case "recent":k.favorites.sort(function(a,b){return a.created()<b.created()});break;default:d=!1,f.error("Invalid sorting provided")}d&&(v=a)})).then(g.$applyAsync)}function p(a){var b=k.favorites.find(function(b){return b.created()===parseInt(a)});if("undefined"!==
typeof b)return b.titleLink().replace("/Record/","")}var v="recent",x=$("#modal"),k=this;k.favSelected={};k.favorites=[];k.sortVal=function(a){return arguments.length?u(a):v};k.allSelected=!1;k.listStart=1;k.listLength=1;k.selectAll=function(){k.favorites.forEach(function(a){k.favSelected[a.created()]=k.allSelected})};k.removeFavorite=n;k.removeSelected=function(){Object.keys(k.favSelected).forEach(function(a){!0===k.favSelected[a]&&(n(parseInt(a)),delete k.favSelected[a])})};k.emailSelected=function(a){x.find(".modal-title").html(a.target.value);
Lightbox.titleSet=!0;r("email")};k.exportSelected=function(){Lightbox.titleSet=!1;r("export")};k.printSelected=function(){var a=w();if(0!==a.length){var b="/Records/Home?print=1";a.forEach(function(a){b+="&id[]=Solr|"+a});window.open(b,"_blank").focus()}};e.resolve(m.getFavorites()).then(function(a){a=a.reverse();k.favorites=a;if(a=a.length)q(),k.listLength=a})["catch"](function(a){f.error(a)});window.__favChanged=function(a,b){b instanceof l&&(!0===a?t(b):!1===a&&(new Promise(function(a,d){var g=
b.created(),f=c[g];window.usesIE?f.parentElement.removeChild(f):f.remove();delete c[g];--k.listLength;0===Object.keys(c).length&&q();k.favorites=k.favorites.filter(function(a){return a.created()!==b.created()});a()})).then(g.$applyAsync))}}angular.module("favorites").controller("ListController",e).directive("favoritesListItem",function(){return{restrict:"A",templateUrl:"/themes/bootstrap3/js/ng-cpk/favorites/list-item.html",link:function(a,b,f){c[a.fav.created()]=b.context}}}).directive("listNotEmpty",
function(){return{restrict:"A",link:function(c,d,f){"true"===f.listNotEmpty?(a=d.context,a.hidden=!0):"false"===f.listNotEmpty&&(b=d.context,b.hidden=!1)}}});e.$inject="$q $http $log $scope storage favsBroadcaster Favorite".split(" ");var c={},b=void 0,a=void 0})();(function(){function e(b,a,e,d,f){function g(){t=e.createFromCurrentRecord();a.addFavorite(t).then(function(){n();f.broadcastAdded(t)})["catch"](function(a){b.error(a)})}function m(){var c=t.created();a.removeFavorite(c).then(function(){n();f.broadcastRemoved(t)})["catch"](function(a){b.error(a)})}function h(){return new Promise(function(b,c){var d=l();a.hasFavorite(d).then(function(a){b(a)})["catch"](c)})}function l(a){return(a=("undefined"===typeof a?location.pathname:a).match(/^\/Record\/([^\?]*)/))?
a[1]:null}function n(){c.remFavBtn.hidden=!c.remFavBtn.hidden;c.addFavBtn.hidden=!c.addFavBtn.hidden;q=!q}var t=void 0,q=!1;this.addOrRemoveFavorite=function(){q?m():g()};this.isFavorite=h;h().then(function(a){t=a;n()});window.__favChanged=function(a,b){b instanceof d&&(!0===a?!1===q&&l(b.titleLink())===l()&&(t=b,n()):!1===a&&!0===q&&b.created()===t.created()&&(t=b,n()))}}angular.module("favorites").controller("RecordFavController",e).directive("addRemoveRecord",function(){return{restrict:"A",link:function(b,
a,e){b=a.context;a=b.getAttribute("data-add-remove-record");"add"===a?(c.addFavBtn=b,b.hidden=!1):"rem"===a&&(c.remFavBtn=b,b.hidden=!0)}}});e.$inject=["$log","storage","favoritesFactory","Favorite","favsBroadcaster"];var c={remFavBtn:void 0,addFavBtn:void 0}})();(function(){function e(a,e,d,f,g,m,h,l){function n(a){z=document.querySelectorAll("div#result-list-placeholder div[id]");"undefined"===typeof a&&d(z)(e);k=z.length;for(var b=0;b<k;++b)r(b).then(function(a){b=a.rank;favorite=a.favorite;v[b]=favorite;p(b)})}function t(){v=[];x=[];c=[];b=[]}function q(a){v[a]=m.createFromCurrentSearch(a);g.addFavorite(v[a]).then(function(){p(a);l.broadcastAdded(v[a])})["catch"](function(a){f.error(a)})}function w(a){var b=v[a].created();g.removeFavorite(b).then(function(){p(a);
l.broadcastRemoved(v[a])})["catch"](function(a){f.error(a)})}function r(a){return new Promise(function(b,c){var d=u(void 0,a);g.hasFavorite(d).then(function(c){b({rank:a,favorite:c})})["catch"](c)})}function u(a,b){return"undefined"!==typeof b?z[b].querySelector("a.title").getAttribute("href").match(/^\/Record\/([^\?]*)/)[1]:("undefined"===typeof a?location.pathname:a).split("/")[2]}function p(a){"undefined"!==typeof b[a]&&b[a]?(c[a].remFavBtn.hidden=!c[a].remFavBtn.hidden,c[a].addFavBtn.hidden=!c[a].addFavBtn.hidden,
x[a]=!x[a]):b[a]=function(){p(a)}}var v=[],x=[];this.addOrRemoveFavorite=function(a){x[a]?w(a):q(a)};this.isFavorite=r;var k,z;n(!0);a.addEventListener("searchResultsLoaded",function(){e.$apply(n())});a.addEventListener("searchResultsLoading",function(){e.$apply(t())});window.__favChanged=function(a,b){if(b instanceof h)if(!0===a)for(var c=0;c<k;++c){if(!1===x[c]&&u(b.titleLink())===u(void 0,c)){v[c]=b;p(c);break}}else if(!1===a)for(c=0;c<k;++c)if(!0===x[c]&&b.created()===v[c].created()){v[c]=b;p(c);
break}}}angular.module("favorites").controller("SearchFavController",e).directive("addRemoveSearch",function(){return{restrict:"A",link:function(a,e,d){a=e.context;d=a.getAttribute("data-add-remove-search").split(":");e=d[0];d=parseInt(d[1]);if("undefined"!==typeof Number.isNaN&&Number.isNaN(d))return console.error("No rank provided to a SearchDirective!");"undefined"===typeof c[d]&&(c[d]={addFavBtn:void 0,remFavBtn:void 0});"add"===e?(c[d].addFavBtn=a,a.hidden=!1):"rem"===e&&(c[d].remFavBtn=a,a.hidden=
!0);"function"===typeof b[d]?b[d].call():b[d]=!0}}});e.$inject="$window $scope $compile $log storage favoritesFactory Favorite favsBroadcaster".split(" ");var c=[],b=[]})();(function(){angular.module("federativeLogin",[])})();(function(){function e(b){function a(){!1===f&&e();return d}function e(){d=localStorage.getItem("__luidps");if(null===d)d=[];else{try{d=JSON.parse(d)}catch(l){b.error("Could not parse lastIdps from localStorage",l),d=[]}var a=document.body.parentNode.getAttribute("lang"),c=location.pathname+location.search;c+=(0<=c.indexOf("?")?"&":"?")+"auth_method=Shibboleth";d.forEach(function(b){b.name=b["name_"+a];b.href=b.href.replace(/target=[^&]*/,"target="+encodeURIComponent(c))})}f=!0}var d=[],f=!1,g=!0;
this.login=function(b){"string"===typeof b&&(b=JSON.parse(b));if(b.isConsolidation)dataLayer.push({event:"action.account",actionContext:{eventCategory:"account",eventAction:"connectedAccount",eventLabel:b.name,eventValue:void 0,nonInteraction:!1}});else{var c="library";"MojeID | Google+ | Facebook | LinkedIn"==b.name&&(c="social");dataLayer.push({event:"action.login",actionContext:{eventCategory:"login",eventAction:c,eventLabel:b.name,eventValue:void 0,nonInteraction:!1}});a();c=d.length;for(var g=
0;g<c;++g)if(d[g].name===b.name){d.splice(g,1);break}d.unshift(b);3<d.length&&d.pop();c=JSON.stringify(d);localStorage.setItem("__luidps",c)}b.warn_msg&&alert(VuFind.translate("warning_safety_login"));window.location.replace(b.href)};this.hasLastIdps=function(){a();return null!==d&&d instanceof Array&&0!==d.length};this.getLastIdps=a;this.showHelpContent=function(){g?c.helpContent.removeAttribute("hidden"):c.helpContent.setAttribute("hidden","hidden");g=!g};return this}angular.module("federativeLogin").controller("FederativeLoginController",
e).directive("ngLastUsed",function(){return{restrict:"A",templateUrl:"/themes/bootstrap3/js/ng-cpk/federative-login/last-used.html"}}).directive("ngHelpContent",function(){return{restrict:"A",link:function(b,a,e){c.helpContent=a.context}}});e.$inject=["$log"];var c={lastUsed:void 0}})();(function(){angular.module("admin",[])})();(function(){function e(){function b(){f.input.className+=" hidden";f.div.removeAttribute("hidden")}function a(a){if(""===a){var b=f.input.required;if("number"===f.input.type)a=f.input.currentTableRow.input.placeholder;else if(b)return!1}b=f.div.getElementsByTagName("ins");if(0===b.length){b=f.div.textContent.trim();if(b===a.trim())return!0;b.length&&(f.div.innerHTML='<del style="color: red">'+b+"</del><br>");b=document.createElement("ins");b.style.color="green";f.div.appendChild(b)}else{var c=f.div.getElementsByTagName("del");
if(c.length&&(c=c[0].textContent.trim(),c===a.trim()))return f.div.innerHTML=c,!0;b=b[0]}b.textContent=a;return!0}function e(){var a=f.div.getElementsByTagName("ins");return 0===a.length?f.div.textContent.trim():a[0].textContent.trim()}var d=void 0,f={div:void 0,input:void 0};this.edit=function(a){f.div=a.currentTarget.children[0];f.input=f.div.nextElementSibling;f.input.className=f.input.className.replace(/\shidden|hidden\s?/g,"");f.div.setAttribute("hidden","hidden");f.input.focus();d=(new Date).getTime()};
this.inputKeyDown=function(d){13===d.keyCode?(d.preventDefault(),a(d.target.value)?b():c.click()):27===d.keyCode&&(d.target.value=e(),b())};this.inputBlurred=function(c){"number"===c.target.type&&(new Date).getTime()-100<d||(a("checkbox"===c.target.type?c.target.checked?"1":"0":c.target.value)||(c.target.value=e()),b())};return this}angular.module("admin").controller("ApprovalController",e).directive("ng-submit-approval",function(){return{restrict:"A",link:function(b,a,e){c=a.context}}});e.$inject=
[];var c=void 0})();(function(){angular.module("history",[])})();(function(){function e(a,e,d,f){function g(b){w.removeAttribute("hidden");p.historyPage=[];r=b;t();a.resolve(m()).then(function(a){var b=a.historyPage;(new Promise(function(a){w.setAttribute("hidden","hidden");p.historyPage=b;return a()})).then(f.$applyAsync).then(l(a.obalky))})["catch"](function(a){e.error(a)})}function m(){return new Promise(function(a,b){var c=r-1;if("undefined"!==typeof u[c])return a(u[c]);d.post("/AJAX/JSON?method=getMyHistoryPage",$.param({cat_username:q,page:r,perPage:p.perPage}),
{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(d){d=d.data;"undefined"!==typeof d.php_errors&&e.error(d.php_errors);if("OK"===d.status)if(u[c]=d.data,"undefined"!==typeof d.data.html&&"undefined"!==typeof d.data.source)$("div#"+d.data.source).html(d.data.html);else return a(d.data);else return b(d.data)})})}function h(c,d){w=c;q=d;a.resolve(m()).then(function(a){var c=a.historyPage,d=a.totalPages;0<d&&(b[q].className=b[q].className.replace("hidden",""));u=Array(d);u[0]=
a;n();(new Promise(function(a){w.setAttribute("hidden","hidden");p.historyPage=c;a()})).then(f.$applyAsync).then(l(a.obalky))})["catch"](function(a){w.innerHTML='<span class="label label-danger">'+a.message+"</span>"})}function l(a){if("undefined"!==typeof a)for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];obalky.fetchImage(b,c.bibInfo,c.advert,"icon")}}function n(){for(var a=[],b=[],c=u.length,d=0;d<c;)b[d++]={number:d,clazz:1===d?"active":""},5>=d&&(a[d-1]=b[d-1]);f.paginator={lastPage:c,visiblePages:a,
pages:b,activePage:1,showFirst:!1,showLast:5<c,goToPage:g}}function t(){(new Promise(function(a){var b=f.paginator.pages;b[f.paginator.activePage-1].clazz="";b[r-1].clazz="active";var c=f.paginator.lastPage,d=3<r,e=r<c-2,m=[],h=r+2,l=3;h>c&&(l=h-c+l,h=c);l=r-l;for(var n=0;l<h;++n,++l)0>l&&(h-=l,h>c&&(h=c),l=0),e&&l===c-1||d&&0===l?--n:m[n]=b[l];f.paginator={lastPage:c,visiblePages:m,pages:b,activePage:r,showFirst:d,showLast:e,goToPage:g};a()})).then(f.$applyAsync)}var q=void 0,w=void 0,r=1,u=[];c=
h;var p=this;p.historyPage=[];p.pageSelected=g;p.perPage="10";p.perPageUpdated=function(){(new Promise(function(a){r=f.paginator.lastPage=1;p.historyPage=[];w.removeAttribute("hidden");a()})).then(f.$applyAsync);u=[];h(w,q)};return p}angular.module("history").controller("CheckedOutHistoryController",e).directive("ngHistoryUsername",function(){return{restrict:"A",link:function(a,b,d){c(b.context,d.ngHistoryUsername)}}}).directive("ngHistoryItem",function(){return{restrict:"A",templateUrl:"/themes/bootstrap3/js/ng-cpk/history/history-item.html"}}).directive("ngPagination",
function(){return{restrict:"A",templateUrl:"/themes/bootstrap3/js/ng-cpk/pagination.html",link:function(a,b,c){a.source=c.ngPagination}}}).directive("ngPagesCount",function(){return{restrict:"A",link:function(a,c,d){b[d.ngPagesCount]=c.context}}}).filter("urlencode",function(){return function(a){return encodeURI(a)}});e.$inject=["$q","$log","$http","$scope"];var c=function(){},b={}})();(function(){angular.module("cpk",["favorites","federativeLogin","admin","history"]).config(["$locationProvider",function(e){e.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}])})();(function(){function e(a,f,e,m,h){function d(a){c("global",function(){new Promise(function(){"undefined"===typeof n&&(n=$("#modal"));n.modal("show")});var c=b.modal.global.header,d=b.modal.global.body;h.get("/AJAX/JSON?method=getPortalPage&prettyUrl="+a).then(function(a){a=a.data.data;c.textContent=a.title;d.innerHTML=a.content},function(a){m.error(a)})})}var g=this;g.getParams=e.search();"undefined"!==typeof g.getParams.viewModal&&d(g.getParams.viewModal);f.$on("notificationClicked",function(){g.getParams=
e.search();"undefined"!==typeof g.getParams.viewModal&&d(g.getParams.viewModal,m,h)});return g}function c(c,e){"undefined"===typeof a.modal[c]&&(a.modal[c]={});if("function"===typeof e){var d=a.modal[c].linkerDone;"boolean"===typeof d&&d?e.call():a.modal[c].callback=e}else{d=!0;for(var f=Object.keys(b.modal[c]),h=f.length,l=0;l<h;++l)if("undefined"===typeof b.modal[c][f[l]]){d=!1;break}d&&(a.modal[c].linkerDone=!0,"function"===typeof a.modal[c].callback&&a.modal[c].callback.call())}}angular.module("cpk").controller("GlobalController",
e).directive("ngModal",function(){return{restrict:"A",link:function(a,e,g){g=g.ngModal.split(".");a=g[0];g=g[1];"undefined"===typeof b.modal[a]&&(b.modal[a]={});b.modal[a][g]=e.context;c(a,g)}}});e.$inject=["favsBroadcaster","$rootScope","$location","$log","$http"];var b={modal:{global:{body:void 0,header:void 0}}},a={modal:{}},n=void 0})();(function(){angular.module("cpk").filter("translate",function(){return function(e){return"translate"in VuFind?VuFind.translate(e):e}})})();
